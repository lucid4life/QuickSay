---
import BaseLayout from './BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description: string;
  date: string;
  author: string;
  readingTime?: string;
}

const { title, description, date, author, readingTime } = Astro.props;

const formattedDate = new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const canonicalUrl = `https://quicksay.app${Astro.url.pathname}`;
---

<BaseLayout
  title={`${title} â€” QuickSay Blog`}
  description={description}
  canonicalUrl={canonicalUrl}
>
  <Navbar slot="header" />

  <div class="blog-wrapper">
    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <ol class="flex items-center gap-1.5 text-sm">
        <li><a href="/" class="text-text-tertiary hover:text-text-secondary transition-colors">Home</a></li>
        <li class="text-text-quaternary">/</li>
        <li><a href="/blog" class="text-text-tertiary hover:text-text-secondary transition-colors">Blog</a></li>
        <li class="text-text-quaternary">/</li>
        <li class="text-text-secondary">{title}</li>
      </ol>
    </nav>

    <article>
      <!-- Header -->
      <header class="mb-10">
        <h1 class="font-headline font-bold text-3xl md:text-4xl text-text-primary leading-tight mb-4 text-balance">
          {title}
        </h1>
        <div class="flex items-center gap-3 text-sm text-text-tertiary">
          <span>{author}</span>
          <span class="text-text-quaternary">|</span>
          <time datetime={date}>{formattedDate}</time>
          {readingTime && (
            <>
              <span class="text-text-quaternary">|</span>
              <span>{readingTime}</span>
            </>
          )}
        </div>
      </header>

      <!-- Article body -->
      <div class="blog-prose">
        <slot />
      </div>
    </article>
  </div>

  <Footer slot="footer" />

  <!-- BlogPosting structured data (schema.org) -->
  <script type="application/ld+json" slot="head" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": title,
    "description": description,
    "datePublished": date,
    "dateModified": date,
    "author": {
      "@type": "Person",
      "name": author,
    },
    "publisher": {
      "@type": "Organization",
      "name": "QuickSay",
      "url": "https://quicksay.app",
      "logo": {
        "@type": "ImageObject",
        "url": "https://quicksay.app/logo.svg"
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": canonicalUrl,
    },
    "image": "https://quicksay.app/og-image.png"
  })} />
</BaseLayout>

<style>
  .blog-wrapper {
    max-width: 720px;
    margin: 0 auto;
    padding: 6rem 1.5rem 4rem;
  }

  .breadcrumb {
    margin-bottom: 2rem;
  }

  /* Prose styles for blog MDX content */
  .blog-prose {
    color: var(--text-secondary);
    font-size: 1.0625rem;
    line-height: 1.8;
  }

  .blog-prose :global(h2) {
    color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
    font-weight: 600;
    font-size: 1.5rem;
    line-height: 1.3;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
  }

  .blog-prose :global(h3) {
    color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
    font-weight: 600;
    font-size: 1.25rem;
    line-height: 1.4;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
  }

  .blog-prose :global(p) {
    margin-bottom: 1.5rem;
  }

  .blog-prose :global(a) {
    color: var(--accent-teal);
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color 150ms ease;
  }

  .blog-prose :global(a:hover) {
    color: #1abfb2;
  }

  .blog-prose :global(strong) {
    color: var(--text-primary);
    font-weight: 600;
  }

  .blog-prose :global(code) {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.875em;
    background-color: #0e0e10;
    color: var(--accent-teal);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
  }

  .blog-prose :global(pre) {
    background-color: #0e0e10 !important;
    border: 1px solid var(--border);
    border-radius: 0.5rem;
    padding: 1rem 1.25rem;
    margin-bottom: 1.5rem;
    overflow-x: auto;
  }

  .blog-prose :global(pre code) {
    background-color: transparent;
    padding: 0;
    font-size: 0.8125rem;
    line-height: 1.7;
    color: var(--text-primary);
  }

  .blog-prose :global(ul),
  .blog-prose :global(ol) {
    padding-left: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .blog-prose :global(ul) {
    list-style-type: disc;
  }

  .blog-prose :global(ol) {
    list-style-type: decimal;
  }

  .blog-prose :global(li) {
    margin-bottom: 0.5rem;
  }

  .blog-prose :global(blockquote) {
    border-left: 3px solid var(--accent-teal);
    padding-left: 1rem;
    margin-left: 0;
    margin-bottom: 1.5rem;
    color: var(--text-secondary);
    font-style: italic;
  }

  .blog-prose :global(hr) {
    border: none;
    border-top: 1px solid var(--border);
    margin: 2.5rem 0;
  }

  .blog-prose :global(table) {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1.5rem;
    font-size: 0.9375rem;
  }

  .blog-prose :global(th) {
    color: var(--text-primary);
    font-weight: 600;
    text-align: left;
    padding: 0.625rem 0.75rem;
    border-bottom: 2px solid var(--border);
  }

  .blog-prose :global(td) {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--border);
    vertical-align: top;
  }

  .blog-prose :global(tr:last-child td) {
    border-bottom: none;
  }

  .blog-prose :global(h2[id]),
  .blog-prose :global(h3[id]) {
    scroll-margin-top: 5rem;
  }
</style>
