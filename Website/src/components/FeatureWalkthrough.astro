---
/* FeatureWalkthrough — 6 feature cards in responsive grid with unique SVG icons */

const features = [
  {
    title: 'Voice Commands',
    description: 'Stay in flow without reaching for the keyboard. Navigate, select, and edit hands-free.',
    delay: 0,
    icon: 'terminal',
  },
  {
    title: '25 Languages',
    description: 'Dictate in any of 25 languages. QuickSay detects which one you\'re speaking automatically.',
    delay: 100,
    icon: 'globe',
  },
  {
    title: 'Custom Dictionary',
    description: 'Your jargon, spelled right every time. Add names, acronyms, and technical terms.',
    delay: 200,
    icon: 'book',
    thumbnail: '/images/Dictionary.png',
    thumbWidth: 786,
    thumbHeight: 694,
  },
  {
    title: 'Smart Punctuation',
    description: 'Speak naturally — periods, commas, and paragraphs appear automatically. No voice commands needed.',
    delay: 300,
    icon: 'punctuation',
    thumbnail: '/images/Processing.png',
    thumbWidth: 791,
    thumbHeight: 695,
  },
  {
    title: 'Recording Presets',
    description: 'Optimize for your environment. Save presets for different microphones and rooms.',
    delay: 400,
    icon: 'sliders',
    thumbnail: '/images/Audio.png',
    thumbWidth: 785,
    thumbHeight: 692,
  },
  {
    title: 'History Export',
    description: 'Every dictation saved and searchable. Filter by date, search by keyword, and export anytime.',
    delay: 500,
    icon: 'history',
    thumbnail: '/images/Statistics.png',
    thumbWidth: 785,
    thumbHeight: 696,
  },
];
---

<section id="features" class="py-24 md:py-32">
  <div class="mx-auto max-w-6xl px-6">
    <!-- Headline -->
    <h2 class="font-headline font-semibold text-3xl md:text-4xl text-text-primary text-balance text-center mb-14 fade-in-up">
      Everything you need for speech-to-text. Nothing you don't.
    </h2>

    <!-- Feature grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {features.map((feature) => (
        <div
          class="bg-surface border border-border rounded-xl p-8 card-hover fade-in-up relative"
          style={`transition-delay: ${feature.delay}ms`}
        >
          <!-- Icon -->
          <div class="text-accent-teal mb-5">
            {feature.icon === 'terminal' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="4 17 10 11 4 5" />
                <line x1="12" y1="19" x2="20" y2="19" />
              </svg>
            )}
            {feature.icon === 'globe' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10" />
                <path d="M2 12h20" />
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
              </svg>
            )}
            {feature.icon === 'book' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                <line x1="8" y1="7" x2="16" y2="7" />
                <line x1="8" y1="11" x2="13" y2="11" />
              </svg>
            )}
            {feature.icon === 'punctuation' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 4L4 8l4 4" />
                <path d="M16 4l4 4-4 4" />
                <line x1="3" y1="16" x2="21" y2="16" />
                <line x1="3" y1="20" x2="14" y2="20" />
              </svg>
            )}
            {feature.icon === 'sliders' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="4" y1="6" x2="20" y2="6" />
                <line x1="4" y1="12" x2="20" y2="12" />
                <line x1="4" y1="18" x2="20" y2="18" />
                <circle cx="8" cy="6" r="2" fill="currentColor" />
                <circle cx="16" cy="12" r="2" fill="currentColor" />
                <circle cx="10" cy="18" r="2" fill="currentColor" />
              </svg>
            )}
            {feature.icon === 'history' && (
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                <path d="M3 3v5h5" />
                <path d="M12 7v5l4 2" />
              </svg>
            )}
          </div>

          <!-- Title -->
          <h3 class="font-headline font-semibold text-lg text-text-primary mb-2">{feature.title}</h3>

          <!-- Description -->
          <p class="font-body text-text-secondary text-sm leading-relaxed">{feature.description}</p>

          <!-- Thumbnail (hidden on mobile, visible tablet+) -->
          {feature.thumbnail && (
            <button
              class="hidden sm:block mt-6 w-full max-w-[160px] overflow-hidden rounded-lg border border-[rgba(255,255,255,0.06)] hover:border-accent-teal transition-all duration-150 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-accent-teal focus:ring-offset-2 focus:ring-offset-background cursor-pointer"
              data-lightbox-trigger
              data-lightbox-src={feature.thumbnail}
              data-lightbox-alt={feature.title === 'Custom Dictionary' ? 'QuickSay custom dictionary panel showing user-defined terms, technical jargon, acronyms, and pronunciation mappings for accurate transcription' : feature.title === 'Smart Punctuation' ? 'QuickSay processing settings showing AI cleanup options for automatic punctuation, capitalization, and formatting' : feature.title === 'Recording Presets' ? 'QuickSay audio settings panel displaying microphone configuration, noise reduction, and quality presets for different recording environments' : feature.title === 'History Export' ? 'QuickSay statistics dashboard showing transcription history with word counts, accuracy metrics, and export options' : `${feature.title} screenshot`}
              aria-label={`View ${feature.title} screenshot`}
            >
              <img
                src={feature.thumbnail}
                alt={feature.title === 'Custom Dictionary' ? 'QuickSay custom dictionary panel showing user-defined terms, technical jargon, acronyms, and pronunciation mappings for accurate transcription' : feature.title === 'Smart Punctuation' ? 'QuickSay processing settings showing AI cleanup options for automatic punctuation, capitalization, and formatting' : feature.title === 'Recording Presets' ? 'QuickSay audio settings panel displaying microphone configuration, noise reduction, and quality presets for different recording environments' : feature.title === 'History Export' ? 'QuickSay statistics dashboard showing transcription history with word counts, accuracy metrics, and export options' : `${feature.title} screenshot`}
                width={feature.thumbWidth}
                height={feature.thumbHeight}
                loading="lazy"
                class="w-full h-auto"
              />
            </button>
          )}
        </div>
      ))}
    </div>

    <!-- Ghost CTA -->
    <div class="text-center mt-10 fade-in-up">
      <a href="/docs" class="text-accent-teal font-medium text-sm hover:underline transition-all duration-150">
        See what's included
      </a>
    </div>
  </div>
</section>

<!-- Lightbox Dialog (native <dialog> with data-attribute triggers) -->
<dialog id="feature-lightbox" class="lightbox-dialog">
  <div class="lightbox-content">
    <button class="lightbox-close" aria-label="Close lightbox">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
        <path d="M18 6L6 18M6 6l12 12"/>
      </svg>
    </button>
    <img id="feature-lightbox-image" alt="" width="800" height="700" class="lightbox-image" />
  </div>
</dialog>

<style>
  /* Lightbox Dialog Styling */
  .lightbox-dialog {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    padding: 0;
    margin: 0;
    border: none;
    background: transparent;
    max-width: 100%;
    max-height: 100vh;
    z-index: 9999;
  }

  .lightbox-dialog::backdrop {
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(8px);
  }

  .lightbox-content {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100vh;
    padding: 2rem;
  }

  .lightbox-image {
    max-width: min(90vw, 800px);
    max-height: 90vh;
    width: auto;
    height: auto;
    object-fit: contain;
    border-radius: 12px;
    box-shadow: 0 8px 48px rgba(0, 0, 0, 0.6);
  }

  .lightbox-close {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(28, 28, 32, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 150ms ease;
    backdrop-filter: blur(8px);
    z-index: 10;
  }

  .lightbox-close:hover {
    background: rgba(28, 28, 32, 1);
    color: var(--text-primary);
    border-color: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
  }

  .lightbox-close:active {
    transform: scale(0.95);
  }
</style>

<script>
  /* Lightbox using data-attribute triggers — ~200 bytes */
  const featureDialog = document.getElementById('feature-lightbox') as HTMLDialogElement;
  const featureImg = document.getElementById('feature-lightbox-image') as HTMLImageElement;
  const featureClose = featureDialog?.querySelector('.lightbox-close');

  // Open lightbox on trigger click
  document.querySelectorAll('[data-lightbox-trigger]').forEach(trigger => {
    trigger.addEventListener('click', () => {
      const src = trigger.getAttribute('data-lightbox-src');
      const alt = trigger.getAttribute('data-lightbox-alt');

      if (featureImg && featureDialog) {
        featureImg.src = src || '';
        featureImg.alt = alt || '';
        featureDialog.showModal();
        document.body.style.overflow = 'hidden';
      }
    });
  });

  // Close on button click
  featureClose?.addEventListener('click', () => {
    featureDialog?.close();
    document.body.style.overflow = '';
  });

  // Close on backdrop click
  featureDialog?.addEventListener('click', (e) => {
    if (e.target === featureDialog) {
      featureDialog.close();
      document.body.style.overflow = '';
    }
  });

  // Close on dialog close (Escape key handled natively)
  featureDialog?.addEventListener('close', () => {
    document.body.style.overflow = '';
  });
</script>
